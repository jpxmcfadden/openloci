SOCIAL ENGINEERING
	!! Talk to Janet --> Have Ron call TMS to find out about acquiring the database (hopefully as CSV)

TECHNICAL STUFF

	Change "subtitle?" on Employees to not be the "notes" section - TEMP FIX - disabled visibility in style sheet
	Fix Main Template so that only using a block for added stylesheet- instead of copying the entire thing over
	Select Customer -> Select Site ... if clicks on Site first, can we get it to auto-select the customer? should these two fields just be combined?
	Go through database and change some columns to CHAR instead of VARCHAR.
	Sanitize all inputs - widget:atts:maxlength / widget:atts:size
		- DONE(ish): Accounts Payable, Vendors
	NOTE: adding "widget:atts:size" to a SELECT field keeps it open 'size' many rows
	Add file upload capabilities for customers/sites/other
	USERS: need to get rid of "Please Select" option from dropdown box if possible, or list info another way. Ideally radio buttons?
	x Vendors > TaxID needs to be validation "required" when 1099 is selected.
	!? Look into why "__validate" is slightly b0rked. - won't print params... only prints "errors" when using the $record. - VENDORS section (1099/TaxID)
	Add show/hide field for checkbox in vendors section
	When adding a new record, the page title defaults to the first item in the list.
	Makes things non-deletable -- add some additional columns for active/inactive
	
FLOW / DATA / INFO
	
	Sections
MEL -->	! Accounts Recievable - Ask M.

-->	Accounting
	
		Employees - SEE "SOFTWARE - Payroll.doc" page 7 to 9, for more info on this.
			Timeclock ID
			? Add emergency contact info?

		Payroll (Employees) - look at page w/ Janet and figure out what needs to be added and how it should work
			? Full / Part - should this be on employee or payroll?
			? Exemptions
			? Pay Period - what goes here? (weekly... what else)
			? Direct Deposit - y/n - do we need this?
			? Vac Time - how do we want this to work? - accrual?
			? YTD - verify: do we need this? keep track of hours: regular / ot / dt?? / holiday / vac
			
			? Income and Deductions
				- set list that gets filled out?
				- or addative list (compares to the way the "rate codes" table works).
				- what categories need to be here? - get clarification!!
				- income / deductions / contributions
			? Move "Workers Comp Code" to payroll, yes?
			- "Payroll hours entered through Service billings should flow through to the employee’s weekly payroll details.  I need to be able to add/update employee details for anything that does not flow through from the Service billing. i.e. adding on-call pay, reimbursements, p/r deductions, etc."
			- "Need to have the ability to print monthly check reports, Quarterly Payroll Reports, Annual Payroll reports, Quarterly Unemployment reports, W-2’s, extract to csv file 401k, 401R & 401L data to submit to 401k Administrators."
			**?!?!?** - "Need the ability to close out P/R on a monthly, quarterly and annual basis."
			- "When an employee makes personal purchase through Airite’s vendor accounts, we setup a tool deduction on the employee’s check to get reimburse for the purchase.  I will need the ability to set up and view the history."
			
		?? General Ledger ??
			Ability to Create Recurring Journal Entries
			Ability to Prepare Manual Journal Entries
			Ability to print General Ledger Reports by Detail Report or Batch
			Closing Procedure
				Check for unposted batches
				If no unposted transactions then print trial balance, Income Statement & Balance Sheets
				When printing any report, have option to view or print.
			Bank Reconciliation
				You can prepare reconciliation based by check number, or manually by check date, amount, etc.
				Ability to view or print Reconciliation Report
				Post after reconciliation is in balance
		

	Service

		Call Slips:
			ADD Fixed data fields for data in the call slips (so that changing an inventory price doesn't effectually back change things)
				- Item -> list cost / sale cost (*auto populate*) - this will also add the ability to override!
				- Time Logs -> Rates - this will also add the ability to override

	
		Customer
BETH -->	Preventative Maintenance (PM) / Contracts - Maybe this should be integrated with "Sites"?
			!x Contract Type - clarification / is this needed? - SEE "SOFTWARE - Service.doc" page 8, for details on types.
				Are these the ones we want? Seems not. Currenly only have "PM", what else?
			!x Billed to Date / Total Due
				How does this work in the current system?
				AUTO - w/ manual button to confirm (check if correct?), but modifyable?
			! Total Contract Amt - what is this? do we need?
			! Adjustments - do we need?
			Billing cycle (shows how much / which months money is due)
				Possibly: Check boxes (Multiple SELECT - always open field?) for each month. Auto divide contract amt / #of months.
			Some sort of history (Year / Term / Price) - Possibly needs option to "Close the year"

			
	Accounts Payable (invoice)
		-- not entry -- Discount if pay by the 10th / Discount % - off pre-tax amount -- links with Vendors
		Other Stuff - SEE "SOFTWARE - Accounts Payable.doc" pages 1 & 2, for details.
		
	Vendors
		Distribution Code - general ledger code most commonly used for that vendor - when pulled into payables, this code is carried over
		! Terms - most are Net 30 (payable 30 days from invoice), need info on other options... need more information here on what to do about this.
		! Due Days - number of days until invoice is due - is this auto?
		x Discount % - % dicount vendor offers (if payed by a certain time) - this links with Accounts Payable
		
		Vendor History - shows all invoices entered, and either open or paid - SEE "SOFTWARE - Vendor.doc" page 5, for more info on this.
			- relationship link to vendor.



			
			
Array ( 
	[0] =>
		Array (
			[inventory_id] => 1
			[quantity] => 1
			[__id__] => call_slips/call_slip_inventory?call_id=9&call_slip_inventory%3A%3Acsi_id=2
			[__order__] => 0
		)
	[1] => Array (
			[inventory_id] => 2 
			[quantity] => 1 
			[__id__] => call_slips/call_slip_inventory?call_id=9&call_slip_inventory%3A%3Acsi_id=3 
			[__order__] => 1 
		)
	[2] => Array ( 
			[inventory_id] => 
			[quantity] => 
			[__id__] => new 
			[__order__] => 999999 )
	[__loaded__] => 1
	)	
			
			
			
			
			
Pulling data from the form beforeSave (using grid widget)			
			
			
			I have a couple instances where I need to do some validation checks / math before I save data. In particular, I need to pull out data that a user has just entered from the form and compare / modify it to the data already saved in the database.

In the past, I did this pretty easily in beforeSave(), with $record->display[$field] for the previously saved data, and $_POST[$field] for the data from the form (not sure if there's a way to do this with the API, but this has been working fine for me, so I never bothered looking in to it), I can then do my math or validation check, and all is well.

Now, I need to do the same thing, but the data that I am checking is in a grid widget. I checked the source and saw that the grid widget names its fields on the order of "field_name_from_fields_ini[row_#]column", but when I tried using that with $_POST, I don't get anything back. Other (non-grid widget) fields return just fine.

I'm not sure how Xataface handles relationship data with respect to the grid widget (I think I read that things are handled in the background via js/ajax), so I'm assuming that either I'm not getting something with the name right (less likely), or that the $_POST method won't work here because it's not handled by the php (more likely). Any suggestions? Is there a way to do with within the API, or at least semi-simply?


Xataface Source:
[code]
<input class="default" id="quantity_inventory_0" name="inventory[0][quantity]" type="text" size="48" data-xf-field="quantity" value="1" onchange="dataGridFieldFunctions.addRowOnChange(this);" style="width:100%;" />
[/code]

Delegate Class:
[code]
	function beforeSave(&$record){

		...

		$inventoryRecords = $record->getRelatedRecords('inventory');

		foreach ($inventoryRecords as $cs_ir){
			$new_q = $_POST['inventory[0][quantity]']; //This isn't working... Will eventually be '[inventory][' . $i . '][quantity]'

			//Do some math using $cs_ir['quantity'] & $new_q;
		}

		...

	}
[/code]

When I display $new_q, I am expecting to get 1, as shown in the source (value="1", or whatever I change this to), but get null / "" instead.

















Not sure if this will help or not, but I've had lots of trouble in the past with sending out mail via php and having services like Yahoo/Hotmail/Gmail auto-block/delete them. I'm not an expert on email, or how those email services do things, but they all take lots of steps to block spam. This ends up more often than not (at least in my case) blocking email generated by websites and/or php.

What I've typically done to solve this is to set up an actual email address (example: confirmation@yourdomain.com), and then use those credentials to send email with. That way it can be verified that the mail is coming from a legit address / email server. And if you're concerned about people responding to an email address that doesn't get checked, just set up an auto-reply message.

I haven't tried using Xataface for sending email though, so